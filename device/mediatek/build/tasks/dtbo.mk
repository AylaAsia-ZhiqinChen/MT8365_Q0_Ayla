ifneq ($(filter $(OUT_DIR)/%,$(BOARD_PREBUILT_DTBOIMAGE)),)
ifdef KERNEL_DIR

ifndef MTK_DTBOIMAGE_CFG
MTK_DTBOIMAGE_CFG := $(KERNEL_OUT)/dtboimg.cfg
.KATI_RESTAT: $(MTK_DTBOIMAGE_CFG)
$(MTK_DTBOIMAGE_CFG): $(KERNEL_ZIMAGE_OUT) ;
endif

ifndef MTK_DTBIMAGE_CFG
MTK_DTBIMAGE_CFG := $(KERNEL_OUT)/dtbimg.cfg
.KATI_RESTAT: $(MTK_DTBIMAGE_CFG)
$(MTK_DTBIMAGE_CFG): $(KERNEL_ZIMAGE_OUT) ;
endif

# mkdtimg is from system/libufdt/utils/src
$(BOARD_PREBUILT_DTBOIMAGE): PRIVATE_TOOL := $(HOST_OUT_EXECUTABLES)/mkdtimg
$(BOARD_PREBUILT_DTBOIMAGE): PRIVATE_CFG := $(MTK_DTBOIMAGE_CFG)
$(BOARD_PREBUILT_DTBOIMAGE): $(HOST_OUT_EXECUTABLES)/mkdtimg
$(BOARD_PREBUILT_DTBOIMAGE): $(MTK_DTBOIMAGE_CFG)
	$(hide) mkdir -p $(dir $@)
	$(PRIVATE_TOOL) cfg_create $@ $(PRIVATE_CFG)

# dtb.img
BOARD_PREBUILT_DTBIMAGE := $(MTK_PTGEN_PRODUCT_OUT)/obj/PACKAGING/dtb/mtk.dtb
$(INSTALLED_DTBIMAGE_TARGET): $(BOARD_PREBUILT_DTBIMAGE)
$(BOARD_PREBUILT_DTBIMAGE): PRIVATE_TOOL := $(HOST_OUT_EXECUTABLES)/mkdtimg
$(BOARD_PREBUILT_DTBIMAGE): PRIVATE_CFG := $(MTK_DTBIMAGE_CFG)
$(BOARD_PREBUILT_DTBIMAGE): $(HOST_OUT_EXECUTABLES)/mkdtimg
$(BOARD_PREBUILT_DTBIMAGE): $(MTK_DTBIMAGE_CFG)
	$(hide) mkdir -p $(dir $@)
	$(PRIVATE_TOOL) cfg_create $@ $(PRIVATE_CFG)

ifeq ($(strip $(MTK_DTBO_UPGRADE_FROM_ANDROID_O)), yes)
.PHONY: odmdtboimage
droidcore: $(PRODUCT_OUT)/$(notdir $(BOARD_PREBUILT_DTBOIMAGE))
odmdtboimage: $(PRODUCT_OUT)/$(notdir $(BOARD_PREBUILT_DTBOIMAGE))
else
droidcore: $(PRODUCT_OUT)/dtbo.img
ifdef BOARD_PREBUILT_DTBIMAGE_DIR
droidcore: $(PRODUCT_OUT)/dtb.img
endif
.PHONY: dtboimage dtbimage
dtboimage: $(PRODUCT_OUT)/dtbo.img
dtbimage: $(PRODUCT_OUT)/dtb.img
endif

endif
endif#BOARD_PREBUILT_DTBOIMAGE
